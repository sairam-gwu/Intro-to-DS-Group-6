group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# 5. Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Name",
names_prefix = "Best_Selling_"
)
# 6. Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_point() +
gghighlight(max(Sales)) +
geom_text_repel(
data = best_selling_games_long,
aes(label = Name, x = Year_of_Release, y = Sales),
box.padding = 0.35
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# 2. Prepare the data
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# 3. Aggregate sales by year and region
yearly_sales <- games %>%
group_by(Year_of_Release) %>%
summarise(
NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)
) %>%
ungroup()
# 4. Identify the best-selling game for each year in each region
best_selling_games <- games %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# 5. Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Name",
names_prefix = "Best_Selling_"
)
# Join best_selling_games_long with yearly_sales_long
best_selling_games_with_sales <- best_selling_games_long %>%
left_join(yearly_sales_long, by = c("Year_of_Release", "Region"))
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_point() +
gghighlight(max(Sales)) +
geom_text_repel(
data = best_selling_games_with_sales,
aes(label = Name, x = Year_of_Release, y = Sales),
box.padding = 0.35
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Aggregate sales by year and region
yearly_sales <- games %>%
group_by(Year_of_Release) %>%
summarise(
NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)
) %>%
ungroup()
# Identify the best-selling game for each year in each region
best_selling_games <- games %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Game_Name",
names_prefix = "Best_Selling_"
) %>%
# Make the region names match between the two data frames
mutate(Region = sub("NA", "NA_Sales", Region)) %>%
mutate(Region = sub("EU", "EU_Sales", Region)) %>%
mutate(Region = sub("JP", "JP_Sales", Region)) %>%
mutate(Region = sub("Other", "Other_Sales", Region))
# Join best_selling_games_long with yearly_sales_long
best_selling_games_with_sales <- yearly_sales_long %>%
left_join(best_selling_games_long, by = c("Year_of_Release", "Region"))
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_text_repel(
data = best_selling_games_with_sales,
aes(label = Game_Name, x = Year_of_Release, y = Sales),
box.padding = 0.35,
max.overlaps = Inf
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Filter for specific regions, let's say North America and Europe
games_filtered <- games %>% filter(Region %in% c("NA_Sales", "EU_Sales"))
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Filter for specific regions, let's say North America and Europe
games_filtered <- games %>% filter(Region %in% c("NA_Sales", "EU_Sales"))
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Optionally, filter out for a range of years if necessary, for example from 2000 to 2010
games_filtered <- games %>% filter(Year_of_Release >= 2000, Year_of_Release <= 2010)
# Aggregate sales by year and region for the filtered data
yearly_sales <- games_filtered %>%
group_by(Year_of_Release) %>%
summarise(
NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)
) %>%
ungroup()
# Continue with the rest of the code...
# Identify the best-selling game for each year in the filtered regions
best_selling_games <- games_filtered %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)]
) %>%
ungroup()
# Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Game_Name",
names_prefix = "Best_Selling_"
)
# Join best_selling_games_long with yearly_sales_long
best_selling_games_with_sales <- yearly_sales_long %>%
left_join(best_selling_games_long, by = c("Year_of_Release", "Region"))
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_text_repel(
data = best_selling_games_with_sales,
aes(label = Game_Name, x = Year_of_Release, y = Sales),
box.padding = 0.35,
max.overlaps = Inf
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(tidyr) # Make sure it's loaded for pivot_longer
top_games_by_region <- function(data, region, n = 10) {
data %>%
group_by(Name) %>%
summarise(Total_Sales = sum(get(region), na.rm = TRUE)) %>%
top_n(n, Total_Sales) %>%
ungroup() %>%
arrange(desc(Total_Sales))
}
# Example for North America
top_na_games <- top_games_by_region(games, "NA_Sales")
# Analyzing cross-regional sales for top NA games
cross_regional_sales <- function(top_games, data) {
data %>%
filter(Name %in% top_games$Name) %>%
select(Name, NA_Sales, EU_Sales, JP_Sales, Other_Sales) %>%
pivot_longer(cols = c(NA_Sales, EU_Sales, JP_Sales, Other_Sales),
names_to = "Region", values_to = "Sales") %>%
arrange(Name, Region)
}
# Example for top NA games
top_na_games_sales <- cross_regional_sales(top_na_games, games)
# Visualizing the sales of top NA games in all regions
ggplot(top_na_games_sales, aes(x = Name, y = Sales, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Sales of Top NA Games in Each Region", x = "Game", y = "Sales")
# Identify top-selling games in the JP region
top_jp_games <- top_games_by_region(games, "JP_Sales")
# Identify top-selling games in the Other region
top_other_games <- top_games_by_region(games, "Other_Sales")
# Analyze cross-regional sales for top EU games
top_eu_games_sales <- cross_regional_sales(top_eu_games, games)
# Analyze cross-regional sales for top JP games
top_jp_games_sales <- cross_regional_sales(top_jp_games, games)
# Analyze cross-regional sales for top Other games
top_other_games_sales <- cross_regional_sales(top_other_games, games)
# Visualizing the sales of top EU games in all regions
ggplot(top_eu_games_sales, aes(x = Name, y = Sales, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Sales of Top EU Games in Each Region", x = "Game", y = "Sales")
# Visualizing the sales of top JP games in all regions
ggplot(top_jp_games_sales, aes(x = Name, y = Sales, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Sales of Top JP Games in Each Region", x = "Game", y = "Sales")
# Visualizing the sales of top Other games in all regions
ggplot(top_other_games_sales, aes(x = Name, y = Sales, fill = Region)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Sales of Top Other Games in Each Region", x = "Game", y = "Sales")
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Filter for specific regions, let's say North America and Europe
games_filtered <- games %>% filter(Region %in% c("NA_Sales", "EU_Sales"))
# Load the required libraries
library(dplyr)
library(ggplot2)
library(gghighlight)
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Aggregate sales by year and region
yearly_sales <- games %>%
group_by(Year_of_Release) %>%
summarise(NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)) %>%
ungroup()
# Identify the best-selling game for each year in each region
best_selling_games <- games %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# Install and load the tidyr package
install.packages("tidyr")  # Run this line if tidyr is not installed yet
library(tidyr)
# Assuming yearly_sales is your data frame
# Melt the yearly sales data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Continue with your plotting or other operations
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Function to highlight and label best-selling games
highlight_best_sellers <- function(plot, best_selling_games, region) {
plot +
gghighlight(max(Sales), unselect_params = list(size = 1)) +
geom_text(data = best_selling_games, aes(label = get(paste0("Best_Selling_", region)),
x = Year_of_Release,
y = yearly_sales[[region]]),
nudge_y = 5, check_overlap = TRUE, color = "black") +
labs(title = paste0("Annual ", region, " Sales and Best-Selling Game"))
}
install.packages("ggrepel")  # Run this line if ggrepel is not installed yet
library(ggrepel)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Name",
names_prefix = "Best_Selling_"
)
# Now use this long format in your geom_text_repel call
highlighted_plot <- sales_plot +
geom_point() +
gghighlight(max(Sales)) +
geom_text_repel(
data = best_selling_games_long,
aes(label = Name, x = Year_of_Release, y = Sales),
box.padding = 0.35
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
install.packages("ggrepel")
install.packages("tidyr")
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Aggregate sales by year and region
yearly_sales <- games %>%
group_by(Year_of_Release) %>%
summarise(
NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)
) %>%
ungroup()
# Identify the best-selling game for each year in each region
best_selling_games <- games %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Game_Name",
names_prefix = "Best_Selling_"
) %>%
# Make the region names match between the two data frames
mutate(Region = sub("NA", "NA_Sales", Region)) %>%
mutate(Region = sub("EU", "EU_Sales", Region)) %>%
mutate(Region = sub("JP", "JP_Sales", Region)) %>%
mutate(Region = sub("Other", "Other_Sales", Region))
# Join best_selling_games_long with yearly_sales_long
best_selling_games_with_sales <- yearly_sales_long %>%
left_join(best_selling_games_long, by = c("Year_of_Release", "Region"))
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_text_repel(
data = best_selling_games_with_sales,
aes(label = Game_Name, x = Year_of_Release, y = Sales),
box.padding = 0.35,
max.overlaps = Inf
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
library(dplyr)
library(ggplot2)
library(gghighlight)
library(tidyr)
library(ggrepel)
# Assuming 'games' is your dataset
games$Year_of_Release <- as.numeric(as.character(games$Year_of_Release))
# Aggregate sales by year and region
yearly_sales <- games %>%
group_by(Year_of_Release) %>%
summarise(
NA_Sales = sum(NA_Sales, na.rm = TRUE),
EU_Sales = sum(EU_Sales, na.rm = TRUE),
JP_Sales = sum(JP_Sales, na.rm = TRUE),
Other_Sales = sum(Other_Sales, na.rm = TRUE)
) %>%
ungroup()
# Identify the best-selling game for each year in each region
best_selling_games <- games %>%
group_by(Year_of_Release) %>%
summarise(
Best_Selling_NA = Name[which.max(NA_Sales)],
Best_Selling_EU = Name[which.max(EU_Sales)],
Best_Selling_JP = Name[which.max(JP_Sales)],
Best_Selling_Other = Name[which.max(Other_Sales)]
) %>%
ungroup()
# Prepare the data for plotting
yearly_sales_long <- yearly_sales %>%
pivot_longer(
cols = -Year_of_Release,
names_to = "Region",
values_to = "Sales"
)
# Pivot the best_selling_games to long format
best_selling_games_long <- best_selling_games %>%
pivot_longer(
cols = starts_with("Best_Selling_"),
names_to = "Region",
values_to = "Game_Name",
names_prefix = "Best_Selling_"
) %>%
# Make the region names match between the two data frames
mutate(Region = sub("NA", "NA_Sales", Region)) %>%
mutate(Region = sub("Other", "Other_Sales", Region))
# Join best_selling_games_long with yearly_sales_long
best_selling_games_with_sales <- yearly_sales_long %>%
left_join(best_selling_games_long, by = c("Year_of_Release", "Region"))
# Create the plot
sales_plot <- ggplot(yearly_sales_long, aes(x = Year_of_Release, y = Sales, color = Region)) +
geom_line() +
geom_point() +
theme_minimal()
# Add labels for best-selling games
highlighted_plot <- sales_plot +
geom_text_repel(
data = best_selling_games_with_sales,
aes(label = Game_Name, x = Year_of_Release, y = Sales),
box.padding = 0.35,
max.overlaps = Inf
) +
labs(title = "Annual Sales by Region with Best-Selling Game Highlighted")
print(highlighted_plot)
