---
title: "HW 5: Confidence Intervals"
author: "Sairam Venkatachalam"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=F}
# The package "ezids" (EZ Intro to Data Science) includes some helper functions we developed for the course. 
# Some of the frequently used functions are loadPkg(), xkabledply(), xkablesummary(), uzscale(), etc.
# You will need to install it (once) from GitHub.
# library(devtools)
# devtools::install_github("physicsland/ezids")
# Then load the package in your R session.
library(ezids)
library(ggplot2)
```


```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, message = F)
# Can globally set option for number display format.
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
```

```{r}
# 1. Do not provide answers/comments inside code blocks (like here) -- those are notes between coders/self and will be ignored for grading. 
# 2. Make sure your knitr options are set to include all results/code to be graded in the final document.
# 3. All charts/graphs/tables should have appropriate titles/labels/captions. 
# 4. Compose your answers using inline R code instead of using the code-block output as much as you can. 
# 5. Your grade is also determined by the style. Even if you answer everything correctly, but the .html does not look appealing, you will not get full credit. Pay attention to the details that we mentioned in class/homework and in previous sample .Rmd files. For example, how to use #, ##, ###, ..., bold face, italics, inline codes, tables, ..., {results = "asis"}, use of colors in plots/ggplots, and so forth.
```

This exercise uses the graduate school admissions dataset from the applicants to a higher-ed institute. The dataset is *LogRegAdmit.csv.*

The variables in the dataset are:  

* `admit`: 0 or 1 (False or True)
* `gre`: gre score
* `gpa`: grade point average at undergraduate level
* `rank`: the ranking of the applicant's undergraduate institute, 1, 2, 3, or 4

# Question 1  
The data set is imported, and the 'admit' and 'rank' attributes are converted into factors 

```{r, echo=T,include=TRUE}

admit=read.csv("C:/Users/saira/OneDrive/Desktop/GWU Courses/Intro to DS/Homework Assignments/HW5/LogRegAdmit.csv")
#str(admit)

admit$admit <- factor(admit$admit)
admit$rank <- factor(admit$rank)

str(admit)

```

# Question 2  
Using the t.test function, the confidence intervals are created for the mean GRE and GPA scores for the entire population of applicants


```{r, echo=T,include=TRUE}
# Confidence level 0.80
ttest80_gre <- t.test(admit$gre, conf.level = 0.80)
ttest80_gpa <- t.test(admit$gpa, conf.level = 0.80)

# Confidence level 0.99
ttest99_gre <- t.test(admit$gre, conf.level = 0.99)
ttest99_gpa <- t.test(admit$gpa, conf.level = 0.99)

print("Confidence level 0.80 - gre variable:")
print(ttest80_gre)
print("Confidence level 0.80 - gpa variable:")
print(ttest80_gpa)
print("Confidence level 0.99 - gre variable:")
print(ttest99_gre)
print("Confidence level 0.99 - gpa variable:")
print(ttest99_gpa)

```


# Question 3  
When looking at the confidence intervals, split by admit status, there is no overlap in the estimated mean GRE scores, in both the 80% and 99% confidence level when comparing admitted vs rejected applicants





```{r, echo=T,include=TRUE}


admit0=subset(admit,admit==0)
admit1=subset(admit,admit==1)



admit_0_ttest80_gre <- t.test(admit0$gre, conf.level = 0.80)
admit_1_ttest80_gre <- t.test(admit1$gre, conf.level = 0.80)

conf_interval_admit0 <- admit_0_ttest80_gre$conf.int
conf_interval_admit1 <- admit_1_ttest80_gre$conf.int

mean_gre_admit0 <- mean(admit0$gre)
mean_gre_admit1 <- mean(admit1$gre)

data <- data.frame(
  group = factor(c("Rejected", "Accepted")),
  mean_gre = c(mean_gre_admit0, mean_gre_admit1),
  range = c(diff(conf_interval_admit0), diff(conf_interval_admit1))
)

ggplot(data, aes(x = mean_gre, y = 5, width = range, fill = group)) +
  geom_bar(stat = "identity", position = "identity", alpha = 0.5) +
  labs(title = "Confidence Interval for 80% confidence level",
       x = "Mean GRE Score") +
  scale_fill_manual(values = c("Rejected" = "red", "Accepted" = "blue"),
                    name = "Admit status") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())




```

The confidence interval at a confidence level of 80% is from **564 to 582** for rejected applicants
and from **606 to 631** for admitted applicants



```{r, echo=T,include=TRUE}



admit_0_ttest99_gre <- t.test(admit0$gre, conf.level = 0.99)
admit_1_ttest99_gre <- t.test(admit1$gre, conf.level = 0.99)


conf_interval_admit0 <- admit_0_ttest99_gre$conf.int
conf_interval_admit1 <- admit_1_ttest99_gre$conf.int

mean_gre_admit0 <- mean(admit0$gre)
mean_gre_admit1 <- mean(admit1$gre)

data <- data.frame(
  group = factor(c("Rejected", "Accepted")),
  mean_gre = c(mean_gre_admit0, mean_gre_admit1),
  range = c(diff(conf_interval_admit0), diff(conf_interval_admit1))
)

ggplot(data, aes(x = mean_gre, y = 5, width = range, fill = group)) +
  geom_bar(stat = "identity", position = "identity", alpha = 0.5) +
  labs(title = "Confidence Interval for 99% confidence level",
       x = "Mean GRE Score") +
  scale_fill_manual(values = c("Rejected" = "red", "Accepted" = "blue"),
                    name = "Admit status") +  
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())




```

The confidence interval at a confidence level of 99% is from **555 to 591** for rejected applicants
and from **594 to 644** for admitted applicants


# Question 4   
Looking at the box plots for the GRE scores of rejected vs admitted students by rank, there are a couple of points to note:


* The median levels for GRE scores are higher across the board for admitted applicants compared to rejected applicants 
* The median GRE scores are higher for rank 1 and 2 schools compared to rank 3 and 4 schools
* There is a higher spread in terms of the inter quartile range, for rank 1 schools in both boxplots




```{r, echo=T,include=TRUE}


#Rejected applicants
ggplot(admit0, aes(x = rank, y = gre)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GRE scores by rank for rejected applicants",
       x = "Undergraduate school rank",
       y = "GRE Score")


#Accepted applicants
ggplot(admit1, aes(x = rank, y = gre)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GRE scores by rank for accepted applicants",
       x = "Undergraduate school rank",
       y = "GRE Score")



```


# Question 5   
Similar to the GRE scores, there is no overlap in the estimated mean GPA scores, in both the 80% and 99% confidence level when comparing admitted vs rejected applicants




```{r, echo=T,include=TRUE}


admit0=subset(admit,admit==0)
admit1=subset(admit,admit==1)



admit_0_ttest80_gpa <- t.test(admit0$gpa, conf.level = 0.80)
admit_1_ttest80_gpa <- t.test(admit1$gpa, conf.level = 0.80)

conf_interval_admit0 <- admit_0_ttest80_gpa$conf.int
conf_interval_admit1 <- admit_1_ttest80_gpa$conf.int

mean_gpa_admit0 <- mean(admit0$gpa)
mean_gpa_admit1 <- mean(admit1$gpa)

data <- data.frame(
  group = factor(c("Rejected", "Accepted")),
  mean_gpa = c(mean_gpa_admit0, mean_gpa_admit1),
  range = c(diff(conf_interval_admit0), diff(conf_interval_admit1))
)

ggplot(data, aes(x = mean_gpa, y = 5, width = range, fill = group)) +
  geom_bar(stat = "identity", position = "identity", alpha = 0.5) +
  labs(title = "Confidence Interval for 80% confidence level",
       x = "Mean GPA Score") +
  scale_fill_manual(values = c("Rejected" = "red", "Accepted" = "blue"),
                    name = "Admit status") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())




```

The confidence interval at a confidence level of 80% is from **3.31 to 3.37** for rejected applicants
and from **3.45 to 3.53** for admitted applicants



```{r, echo=T,include=TRUE}



admit_0_ttest99_gpa <- t.test(admit0$gpa, conf.level = 0.99)
admit_1_ttest99_gpa <- t.test(admit1$gpa, conf.level = 0.99)


conf_interval_admit0 <- admit_0_ttest99_gpa$conf.int
conf_interval_admit1 <- admit_1_ttest99_gpa$conf.int

mean_gpa_admit0 <- mean(admit0$gpa)
mean_gpa_admit1 <- mean(admit1$gpa)

data <- data.frame(
  group = factor(c("Rejected", "Accepted")),
  mean_gpa = c(mean_gpa_admit0, mean_gpa_admit1),
  range = c(diff(conf_interval_admit0), diff(conf_interval_admit1))
)

ggplot(data, aes(x = mean_gpa, y = 5, width = range, fill = group)) +
  geom_bar(stat = "identity", position = "identity", alpha = 0.5) +
  labs(title = "Confidence Interval for 99% confidence level",
       x = "Mean GPA Score") +
  scale_fill_manual(values = c("Rejected" = "red", "Accepted" = "blue"),
                    name = "Admit status") +  
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())




```

The confidence interval at a confidence level of 99% is from **3.28 to 3.40** for rejected applicants
and from **3.40 to 3.58** for admitted applicants



# Question 6   
The box plots for the GPA scores of rejected vs admitted students by rank produce the following points of note:


* The median levels for GPA scores are higher across the board for admitted applicants compared to rejected applicants. This follows the trend observed with GRE scores 
* Unlike GRE scores, the GPA median levels across ranks seem to increase, but this is prevalent only in the case of rejected applicants





```{r, echo=T,include=TRUE}

#Rejected applicants
ggplot(admit0, aes(x = rank, y = gpa)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GPA scores by rank for rejected applicants",
       x = "Undergraduate school rank",
       y = "GPA Score")


#Accepted applicants
ggplot(admit1, aes(x = rank, y = gpa)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GPA scores by rank for accepted applicants",
       x = "Undergraduate school rank",
       y = "GPA Score")


```


# Question 7  

We conducted the t-tests for the sample split by admitted and rejected applicants and observed no overlap in the estimated mean GRE and GPA for the 99% confidence interval.
This suggests a statistically significant difference between the two groups at the 99% confidence level 
The following inferences can be drawn

- **Statistical Significance**: The lack of overlap in the confidence intervals indicates that the difference in mean GRE and GPA scores between the admitted and rejected applicants is likely not due to random chance.

- **High Confidence**: The 99% confidence level indicates with a high confidence that the true population means for GRE and GPA are indeed different between the two groups.

- **Practical Significance**: The practical significance of this result is that the GRE and GPA have a substantial impact on the selection process, and the admitted students have notably higher GRE and GPA scores.


The following charts further emphasize this point

```{r, echo=T,include=TRUE}
#GRE
ggplot(admit, aes(x = admit, y = gre)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GRE scores by admit status ",
       x = "Admit status",
       y = "GRE Score")



#GPA

ggplot(admit, aes(x = admit, y = gpa)) +
  geom_boxplot(fill = "pink", color = "black") +
  labs(title = "Boxplot of GPA scores by admit status ",
       x = "Admit status",
       y = "GPA Score")


#Scatter chart

ggplot(admit, aes(x = gpa, y = gre,color=admit)) +
  geom_point(size = 3) +
  labs(title = "Scatter Plot of GPA vs GRE, Colored by admit status", y = "GRE", x = "GPA")

```

The box plots show clearly that admitted applicants have much higher GPA and GRE scores on average

As the scatter chart suggests, applicants with a low GRE and GPA score are unlikely to get the admit, while there is a general trend of higher admissions as the GRE and GPA scores increase


```{r, echo=T,include=TRUE}

library(dplyr)
percentage_data <- admit %>%
  group_by(rank, admit) %>%
  summarise(count = n()) %>%
  mutate(percentage = (count / sum(count)) * 100)

# Create the bar plot
ggplot(percentage_data, aes(x = rank, y = percentage, fill = factor(admit))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Percentage of Admitted and Rejected applicants by School Rank",
    x = "School Rank",
    y = "Percentage (%)",
    fill = "Admit"
  ) +
  scale_fill_manual(values = c("0" = "#D32D41", "1" = "#6AB187")) +
  theme_minimal()
```

As this bar chart suggests, the proportion of admitted vs rejected applicants by school rank shows a trend that favours schools with a higher rank ie: 1 or 2

